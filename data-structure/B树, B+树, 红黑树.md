#### B树

---

B树分为2-3数，2-3-4数，也就是一个节点可以包含多个value，然后也有多个指针指向多个儿子

儿子按照value的区间决定去往哪个方向。

B树的概念并不难理解，常规查找操作也很容易，难点在于插入和删除

##### 插入

1. 如果已经有同样的值 插入失败

2. 如果待插入的节点不是 4 节点(也就是该节点还没有满)，那么直接在该节点插入。

3. 如果待插入的节点是个 4 节点(也就是说该节点已经满了)，应该先分裂该节点然后再插入，一个 4 节点(包含3个value)可以分裂成一个根节点和两个子节点

   注意 分裂完成的节点要考虑是否和上层合并的情况，也就是要将分裂出来的这个新的树，插入到原树中，如果他的父节点也是4节点 也是满了的 那就需要在对其父节点进行分裂 以此类推

##### 删除

1. 如果是叶子节点非2节点 也是就是如果不是删除只有一个元素的节点 同时还是叶子节点 那就可以直接删除
2. 非叶子节点 先使用中序遍历找到待删除节点的后继节点，然后将后继节点与待删除节点位置互换，此时就将问题转化为删除节点为叶子节点
3. 如果是叶子节点的2节点 
   - 当前节点的父节点是 2- 节点，兄弟节点不为 2- 节点，则将兄弟节点的一个 key 上移成父节点，而父节点下移成子节点，此时树满足 2-3-4 树，完成调整。
   - 当前节点的父节点是 2-节点，兄弟节点也为 2- 节点，则此时将父节点与兄弟节点合并，将合并后的节点看成当前节点，然后重复的判断
   - 当前节点的父节点不为 2- 节点，即此时有两个或三个兄弟节点，此时需要根据相邻兄弟节点情形进行调整，规则如下：1. 若当前节点的相邻兄弟节点为非 3 个 key ，则父节点的一个 key 下移，与相邻兄弟节点合并，此时树满足2-3树，完成调整。2. 若当前节点的相邻兄弟节点为 3 个 key ，则父节点的一个 key 下移成 1 个 key 的节点，相邻兄弟节点的一个 key 上移与父节点合并，此时树满足 2-3-4 树，完成调整。

---

B+树

![image-20220713185013294](/Users/whz/Library/Application Support/typora-user-images/image-20220713185013294.png)

---

#### 红黑树

红黑树和普通平衡树的差距在于

普通平衡树是严格平衡的 所以高度一定是最短的情况

但是红黑树不是严格的 相同节点高度会高于平衡树

所以红黑树在插入的时候会有更少的操作 例如更少的旋转

所以红黑树更适合于插入删除多的情况

而普通平衡树更适合读多的情况

---

红黑树的性质

 *性质1：每个节点要么是黑色，要么是红色。*  

*性质2：根节点是黑色。* 

 *性质3：每个叶子节点（NIL）是黑色。*

*性质4：每个红色结点的两个子结点一定都是黑色。*

性质5：任意一结点到每个叶子结点的路径都包含数量相同的黑结点。（保证这棵树尽量是平衡的。）

